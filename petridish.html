<html>
<script src="dist/cacatoo.js"></script>                 <!-- Include cacatoo library (compiled with rollup) -->
<script src="lib/all.js"></script>                      <!-- Include other libraries (concattenated in 1 file) -->
<link rel="stylesheet" href="style/cacatoo.css">        <!-- Set style sheet -->

<script>
/*-----------------------Start user-defined code ---------------------*/

let model;

function setup()
{

    let config = {
            title: "Petridish with local growth",
            description: "",
            maxtime: 1000,
            fastmode: true,             // If possible, fast-mode will update the model with more than 60 FPS. 
                                        // Note: fastmode is only useful/recommended if the model can readily run 
                                        // at 60FPS without fast-mode, and may actually reduce the reported FPS
                                        // Nevertheless, the final state of the CA is reaches sooner in real time. 
            ncol : 200,            
            nrow : 200,		            // dimensions of the grid to build
            wrap : [true, false],       // Wrap boundary [COLS, ROWS]   
            scale : 2,				    // scale of the grid (nxn pixels per CA cell)
            statecolours: {'alive':{1:'#AAAA00'}}   // The background state '0' is never drawn
    }

    model = new Model(config)

    model.makeGrid("cells"); 

    let birth_rate = 0.25
    let death_rate = 0.01

    //model.initialGrid(model.cells,'alive',0,1,0.01)
    model.cells.grid[config.ncol/2][config.nrow/2]['alive'] = 1
    
    
    model.cells.nextState = function(i,j)       // Define the next-state function. This example is stochastic growth in a petri dish
    {   
        if(this.grid[i][j].alive == 1)
        {
            if(model.rng.random() < death_rate) this.grid[i][j].alive = 0
        }
        else
        {
            //let neighbours = model.cells.countMoore8(this,i,j,1,'alive')              // In the Moore8 neighbourhood of this CA count # of 1's for the 'alive' property        
            let neighbour = model.cells.randomMoore8(this,i,j)              // In the Moore8 neighbourhood of this CA count # of 1's for the 'alive' property        
            if (neighbour.alive == 1 && model.rng.genrand_real1() < birth_rate)                        
                this.grid[i][j].alive = 1;
        }
    }
    
    model.cells.update = function()
    {
        this.synchronous()         // Applied as many times as it can in 1/60th of a second
    }
  
    model.start()
}


/*-------------------------End user-defined code ---------------------*/

</script>




<body onload="setup()">        
    <div class="header" id="header"><h2>ModelJS - </h2></div>
    <div class="content" id="canvas_holder"></div>
    <div class="content" id="form_holder"></div>    
    <div class="content" id="graph_holder"> </div>
    <div class="footer" id="footer"></div>
</body>
</html>